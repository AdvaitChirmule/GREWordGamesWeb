@{
    ViewData["Title"] = "WaitingRoom";
}

@model RoomDetails

<h1>Waiting Room</h1>

<label for="joinRoomNumber" class="form-label">Enter Room Number</label>
<input type="text" class="form-control" id="joinRoomNumber" name="joinRoomNumber" />

<label for="joinPassword" class="form-label">Enter Password (if any)</label>
<input type="text" class="form-control" id="joinPassword" name="joinPassword" />

<button class="btn btn-primary" type="submit" onclick="getRoom()">Join Room</button>

<label for="enterPassword" class="form-label">Enter Password (optional)</label>
<input type="text" id="enterPassword" name="enterPassword" class="form-control"/>

<button class="btn btn-primary" type="submit" onclick="setRoom()">Set Room</button>

<div id="messageBar"></div>
<div id="addedRoom"></div>

<script>
    function setRoom(){
        var addRoomDetails = document.getElementById("addedRoom");
        var messageBar = document.getElementById("messageBar");

        var passwordInput = document.getElementById("enterPassword").value;

        $.ajax({
            url: "/HostRoom",
            type: "GET",
            data: { password: passwordInput }
        }).done(response => {
            if (response.success) {
                addRoomDetails.innerHTML = "<h1>" + response.roomNumber.toString() + "</h1>";
                messageBar.innerHTML = response.message;
            }
            messageBar.innerHTML = response.message;

        }).fail(response => {
            messageBar.innserHTML = "Unexpected Error Occured";
        });
    }

    function getRoom() {
        var messageBar = document.getElementById("messageBar");

        var joinPassword = document.getElementById("joinPassword").value;
        var joinRoomNumber = document.getElementById("joinRoomNumber").value;

        $.ajax({
            url: "/JoinRoom",
            type: "GET",
            data: { roomNumber: joinRoomNumber, password: joinPassword }
        }).done(response => {
            if (response.success) {
                messageBar.innerHTML = "Joined Room";
            }
            else {
                messageBar.innerHTML = response.message;
            }
        }).fail(response => {
            messageBar.innerHTML = "Unexpected Error Occured";
        });
    }
</script>

